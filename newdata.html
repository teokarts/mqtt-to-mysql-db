<!DOCTYPE html>
<html>

  <head>
    <title>New Data Settings</title>
    <link rel="stylesheet" type="text/css" href="custom.css">
  </head>

  <body>

    <div id="panel" class="panel">
      <h1>DB Table Creation</h1>
      <p>Both fields are required</p>
      <div id="message" class="info-box" style="display: none;"></div>
      <form id="settingsForm">
        <label for="table">Table Name:</label>
        <input type="text" id="table" name="table" required><br><br>
        <label for="jsonString">JSON String:</label><br>
        <textarea id="jsonString" name="jsonString" rows="5" cols="50" required></textarea><br><br><br><br>
        <button type="button" id="createTableBtn">CREATE TABLE</button>
        <button type="button" id="homeBtn">HOME</button>
      </form>
    </div>

    <script>
      document.getElementById("homeBtn").onclick = function () {
        window.location.href = "index.html";
      };

      document.getElementById("createTableBtn").onclick = function () {
        const table = document.getElementById("table").value;
        const jsonString = document.getElementById("jsonString").value;

        // Make AJAX request to server to create table and handle success/failure
        const xhr = new XMLHttpRequest();
        xhr.open("POST", "/createTable", true);
        xhr.setRequestHeader("Content-Type", "application/json");
        xhr.onreadystatechange = function () {
          if (xhr.readyState === XMLHttpRequest.DONE) {
            const response = JSON.parse(xhr.responseText);
            if (response.success) {
              document.getElementById("message").innerText = "Table created successfully!";
              document.getElementById("message").style.display = "block";
            } else {
              document.getElementById("message").innerText = response.message;
              document.getElementById("message").style.display = "block";
            }
          }
        };
        xhr.send(JSON.stringify({ table: table, jsonString: jsonString }));
      };
    </script>

  </body>

</html>